--- /media/li/49a1783b-4a46-45fd-a627-9fa5113283b8/li/out111/source/arch/arm/boot/dts/qcom/sdm660.dtsi	2022-01-10 10:02:23.674296601 +0800
+++ /media/Desktop/123/sdm660.dtsi.txt	2022-01-10 10:58:51.795333300 +0800
@@ -1,5 +1,4 @@
 /* Copyright (c) 2016-2018, The Linux Foundation. All rights reserved.
- * Copyright (C) 2019 XiaoMi, Inc.
  *
  * This program is free software; you can redistribute it and/or modify
  * it under the terms of the GNU General Public License version 2 and
@@ -35,7 +34,7 @@
 
 	chosen {
 		stdout-path = "serial0";
-		bootargs = "rcupdate.rcu_normal_after_boot=1 quiet noirqdebug nodebugmon rcu_nocbs=0-3 kpti=0";
+		bootargs = "rcupdate.rcu_expedited=1";
 	};
 
 	psci {
@@ -49,16 +48,15 @@
 
 		CPU0: cpu@0 {
 			device_type = "cpu";
-			compatible = "arm,kryo";
+			compatible = "arm,armv8";
 			reg = <0x0 0x0>;
-			clock-frequency = <1843200000>;
 			enable-method = "psci";
 			qcom,limits-info = <&mitigation_profile0>;
 			qcom,lmh-dcvs = <&lmh_dcvs0>;
 			qcom,ea = <&ea0>;
 			efficiency = <1024>;
-			sched-energy-costs = <&CPU_COST_0 &CLUSTER_COST_0>;
 			next-level-cache = <&L2_0>;
+			sched-energy-costs = <&CPU_COST_0 &CLUSTER_COST_0>;
 			L2_0: l2-cache {
 				compatible = "arm,arch-cache";
 				cache-level = <2>;
@@ -80,16 +78,15 @@
 
 		CPU1: cpu@1 {
 			device_type = "cpu";
-			compatible = "arm,kryo";
+			compatible = "arm,armv8";
 			reg = <0x0 0x1>;
-			clock-frequency = <1843200000>;
 			enable-method = "psci";
 			qcom,limits-info = <&mitigation_profile0>;
 			qcom,lmh-dcvs = <&lmh_dcvs0>;
 			qcom,ea = <&ea1>;
 			efficiency = <1024>;
-			sched-energy-costs = <&CPU_COST_0 &CLUSTER_COST_0>;
 			next-level-cache = <&L2_0>;
+			sched-energy-costs = <&CPU_COST_0 &CLUSTER_COST_0>;
 			L1_I_1: l1-icache {
 				compatible = "arm,arch-cache";
 				qcom,dump-size = <0x9040>;
@@ -105,16 +102,15 @@
 
 		CPU2: cpu@2 {
 			device_type = "cpu";
-			compatible = "arm,kryo";
+			compatible = "arm,armv8";
 			reg = <0x0 0x2>;
-			clock-frequency = <1843200000>;
 			enable-method = "psci";
 			qcom,limits-info = <&mitigation_profile0>;
 			qcom,lmh-dcvs = <&lmh_dcvs0>;
 			qcom,ea = <&ea2>;
 			efficiency = <1024>;
-			sched-energy-costs = <&CPU_COST_0 &CLUSTER_COST_0>;
 			next-level-cache = <&L2_0>;
+			sched-energy-costs = <&CPU_COST_0 &CLUSTER_COST_0>;
 			L1_I_2: l1-icache {
 				compatible = "arm,arch-cache";
 				qcom,dump-size = <0x9040>;
@@ -130,16 +126,15 @@
 
 		CPU3: cpu@3 {
 			device_type = "cpu";
-			compatible = "arm,kryo";
+			compatible = "arm,armv8";
 			reg = <0x0 0x3>;
-			clock-frequency = <1843200000>;
 			enable-method = "psci";
 			qcom,limits-info = <&mitigation_profile0>;
 			qcom,lmh-dcvs = <&lmh_dcvs0>;
 			qcom,ea = <&ea3>;
 			efficiency = <1024>;
-			sched-energy-costs = <&CPU_COST_0 &CLUSTER_COST_0>;
 			next-level-cache = <&L2_0>;
+			sched-energy-costs = <&CPU_COST_0 &CLUSTER_COST_0>;
 			L1_I_3: l1-icache {
 				compatible = "arm,arch-cache";
 				qcom,dump-size = <0x9040>;
@@ -155,16 +150,15 @@
 
 		CPU4: cpu@100 {
 			device_type = "cpu";
-			compatible = "arm,kryo";
+			compatible = "arm,armv8";
 			reg = <0x0 0x100>;
-			clock-frequency = <2457600000>;
 			enable-method = "psci";
 			qcom,limits-info = <&mitigation_profile1>;
 			qcom,lmh-dcvs = <&lmh_dcvs1>;
 			qcom,ea = <&ea4>;
 			efficiency = <1638>;
-			sched-energy-costs = <&CPU_COST_1 &CLUSTER_COST_1>;
 			next-level-cache = <&L2_1>;
+			sched-energy-costs = <&CPU_COST_1 &CLUSTER_COST_1>;
 			L2_1: l2-cache {
 				compatible = "arm,arch-cache";
 				cache-level = <2>;
@@ -184,16 +178,15 @@
 
 		CPU5: cpu@101 {
 			device_type = "cpu";
-			compatible = "arm,kryo";
+			compatible = "arm,armv8";
 			reg = <0x0 0x101>;
-			clock-frequency = <2457600000>;
 			enable-method = "psci";
 			qcom,limits-info = <&mitigation_profile2>;
 			qcom,lmh-dcvs = <&lmh_dcvs1>;
 			qcom,ea = <&ea5>;
 			efficiency = <1638>;
-			sched-energy-costs = <&CPU_COST_1 &CLUSTER_COST_1>;
 			next-level-cache = <&L2_1>;
+			sched-energy-costs = <&CPU_COST_1 &CLUSTER_COST_1>;
 			L1_I_101: l1-icache {
 				compatible = "arm,arch-cache";
 				qcom,dump-size = <0x12000>;
@@ -209,16 +202,15 @@
 
 		CPU6: cpu@102 {
 			device_type = "cpu";
-			compatible = "arm,kryo";
+			compatible = "arm,armv8";
 			reg = <0x0 0x102>;
-			clock-frequency = <2457600000>;
 			enable-method = "psci";
 			qcom,limits-info = <&mitigation_profile3>;
 			qcom,lmh-dcvs = <&lmh_dcvs1>;
 			qcom,ea = <&ea6>;
 			efficiency = <1638>;
-			sched-energy-costs = <&CPU_COST_1 &CLUSTER_COST_1>;
 			next-level-cache = <&L2_1>;
+			sched-energy-costs = <&CPU_COST_1 &CLUSTER_COST_1>;
 			L1_I_102: l1-icache {
 				compatible = "arm,arch-cache";
 				qcom,dump-size = <0x12000>;
@@ -234,16 +226,15 @@
 
 		CPU7: cpu@103 {
 			device_type = "cpu";
-			compatible = "arm,kryo";
+			compatible = "arm,armv8";
 			reg = <0x0 0x103>;
-			clock-frequency = <2457600000>;
 			enable-method = "psci";
 			qcom,limits-info = <&mitigation_profile4>;
 			qcom,lmh-dcvs = <&lmh_dcvs1>;
 			qcom,ea = <&ea7>;
 			efficiency = <1638>;
-			sched-energy-costs = <&CPU_COST_1 &CLUSTER_COST_1>;
 			next-level-cache = <&L2_1>;
+			sched-energy-costs = <&CPU_COST_1 &CLUSTER_COST_1>;
 			L1_I_103: l1-icache {
 				compatible = "arm,arch-cache";
 				qcom,dump-size = <0x12000>;
@@ -294,72 +285,141 @@
 				};
 			};
 		};
-	};
-
-	energy_costs: energy-costs {
-		compatible = "sched-energy";
-
-		CPU_COST_0: core-cost0 {
-			busy-cost-data = <
-				 300000   19
-				 633600   41
-				 902400   79
-				1113600  115
-				1401600  204
-				1536000  233
-				1612800  257
-				1843200  293
-			>;
-			idle-cost-data = <
-				20 16 10 8
-			>;
-		};
-		CPU_COST_1: core-cost1 {
-			busy-cost-data = <
-				 300000  100
-				 633600  160
-				 902400  265
-				1113600  370
-				1401600  519
-				1747200  827
-				1958400  958
-				2150400 1080
-				2457600 1202
-			>;
-			idle-cost-data = <
-				100 80 60 40
-			>;
-		};
-		CLUSTER_COST_0: cluster-cost0 {
-			busy-cost-data = <
-				 300000  4
-				 633600  8
-				 902400 14
-				1113600 20
-				1401600 29
-				1536000 35
-				1612800 39
-				1843200 44
-			>;
-			idle-cost-data = <
-				4 3 2 1
-			>;
-		};
-		CLUSTER_COST_1: cluster-cost1 {
-			busy-cost-data = <
-				 300000  36
-				 633600  62
-				 902400  98
-				1113600 135
-				1401600 193
-				1747200 272
-				1958400 317
-				2150400 357
-				2457600 397
-			>;
-			idle-cost-data = <
-				4 3 2 1
-			>;
+		energy-costs {
+			CPU_COST_0: core-cost0 {
+				busy-cost-data = <
+					65  11
+					80  20
+					96  25
+					113 30
+					130 33
+					147 35
+					164 36
+					181 42
+					194 47
+					211 54
+					228 62
+					243 67
+					258 73
+					275 79
+					292 88
+					308 95
+					326 104
+					342 111
+					368 134
+					384 155
+					401 178
+					419 201
+				>;
+				idle-cost-data = <
+					4 4 0 0
+				>;
+			};
+			CPU_COST_1: core-cost1 {
+				busy-cost-data = <
+					129  56
+					148  76
+					182  91
+					216  105
+					247  118
+					278  135
+					312  150
+					344  162
+					391  181
+					419  196
+					453  214
+					487  229
+					509  248
+					546  280
+					581  316
+					615  354
+					650  392
+					676  439
+					712  495
+					739  565
+					776  622
+					803  691
+					834  792
+					881  889
+					914  1059
+					957  1244
+					975  1375
+					996  1549
+					1016 1617
+					1021 1677
+					1024 1683
+				>;
+				idle-cost-data = <
+					10 10 0 0
+				>;
+			};
+			CLUSTER_COST_0: cluster-cost0 {
+				busy-cost-data = <
+					65  17
+					80  18
+					96  18
+					113 20
+					130 21
+					147 22
+					164 23
+					181 24
+					194 27
+					211 29
+					228 30
+					243 32
+					258 33
+					275 35
+					292 38
+					308 39
+					326 42
+					342 46
+					368 48
+					384 53
+					401 59
+					419 66
+				>;
+				idle-cost-data = <
+					31 31 31 0
+				>;
+			};
+			CLUSTER_COST_1: cluster-cost1 {
+				busy-cost-data = <
+					129  24
+					148  25
+					182  26
+					216  29
+					247  30
+					278  33
+					312  35
+					344  37
+					391  38
+					419  40
+					453  43
+					487  44
+					509  46
+					546  50
+					581  54
+					615  60
+					650  63
+					676  70
+					712  74
+					739  80
+					776  87
+					803  96
+					834  104
+					881  120
+					914  130
+					957  171
+					975  178
+					996  185
+					1016 200
+					1021 202
+					1024 203
+				>;
+				idle-cost-data = <
+					50 50 50 0
+				>;
+			};
 		};
 	};
 
@@ -501,7 +561,7 @@
 		};
 
 		dfps_data_mem: dfps_data_mem@0x9f7ff000 {
-		       reg = <0 0x9f800000 0 0x00001000>;
+		       reg = <0 0x9f7ff000 0 0x00001000>;
 		       label = "dfps_data_mem";
 		};
 
@@ -748,7 +808,7 @@
 			compatible = "qcom,memshare-peripheral";
 			qcom,peripheral-size = <0x0>;
 			qcom,client-id = <1>;
-			qcom,allocate-on-request;
+			qcom,allocate-boot-time;
 			label = "modem";
 		};
 	};
@@ -777,17 +837,15 @@
 		clock-names = "core", "iface";
 	};
 
-/*
-        qcom,qbt1000 {
-		compatible = "qcom,qbt1000";
-		clock-names = "core", "iface";
-		clocks = <&clock_gcc GCC_BLSP1_QUP3_SPI_APPS_CLK>,
-			<&clock_gcc GCC_BLSP1_AHB_CLK>;
-		clock-frequency = <15000000>;
-		qcom,ipc-gpio = <&tlmm 72 0>;
-		qcom,finger-detect-gpio = <&pm660_gpios 11 0>;
-	};
-*/
+//	qcom,qbt1000 {
+//		compatible = "qcom,qbt1000";
+//		clock-names = "core", "iface";
+//		clocks = <&clock_gcc GCC_BLSP1_QUP3_SPI_APPS_CLK>,
+//			<&clock_gcc GCC_BLSP1_AHB_CLK>;
+//		clock-frequency = <15000000>;
+//		qcom,ipc-gpio = <&tlmm 72 0>;
+//		qcom,finger-detect-gpio = <&pm660_gpios 11 0>;
+//	};
 
 	qcom,sensor-information {
 		compatible = "qcom,sensor-information";
@@ -895,9 +953,10 @@
 			qcom,sensor-type = "llm";
 			qcom,sensor-name = "limits_sensor-01";
 		};
+
 		sensor_information22: qcom,sensor-information-22 {
 			qcom,sensor-type = "adc";
-			qcom,sensor-name = "backlight_therm";
+			qcom,sensor-name = "id3_therm";
 		};
 	};
 
@@ -929,9 +988,9 @@
 	qcom,msm-thermal {
 		compatible = "qcom,msm-thermal";
 		qcom,sensor-id = <1>;
-		qcom,poll-ms = <100>;
+		qcom,poll-ms = <250>;
 		qcom,therm-reset-temp = <115>;
-		qcom,core-limit-temp = <70>;
+		qcom,core-limit-temp = <90>;
 		qcom,core-temp-hysteresis = <10>;
 		qcom,hotplug-temp = <105>;
 		qcom,hotplug-temp-hysteresis = <20>;
@@ -979,14 +1038,16 @@
 		compatible = "qcom,bcl";
 		qcom,bcl-enable;
 		qcom,bcl-framework-interface;
-		qcom,bcl-hotplug-list = <>;
-		qcom,bcl-soc-hotplug-list = <>;
+		/*qcom,bcl-hotplug-list = <&CPU4 &CPU5 &CPU6 &CPU7>;*/
+		/*qcom,bcl-soc-hotplug-list = <&CPU4 &CPU5 &CPU6 &CPU7>;*/
+		/delete-property/ qcom,bcl-hotplug-list;
+		/delete-property/ qcom,bcl-soc-hotplug-list;
 		qcom,ibat-monitor {
 			qcom,low-threshold-uamp = <3400000>;
 			qcom,high-threshold-uamp = <4200000>;
 			qcom,vph-high-threshold-uv = <3500000>;
 			qcom,vph-low-threshold-uv = <3300000>;
-			qcom,soc-low-threshold = <10>;
+			qcom,soc-low-threshold = <5>;
 		};
 	};
 
@@ -998,9 +1059,8 @@
 	qcom,msm-core@780000 {
 		compatible = "qcom,apss-core-ea";
 		reg = <0x780000 0x1000>;
-		qcom,low-hyst-temp = <10>;
-		qcom,high-hyst-temp = <5>;
-		qcom,polling-interval = <100>;
+		qcom,low-hyst-temp = <100>;
+		qcom,high-hyst-temp = <100>;
 
 		ea0: ea0 {
 			sensor = <&sensor_information1>;
@@ -1329,11 +1389,11 @@
 		compatible = "qcom,arm-memlat-mon";
 		qcom,cpulist = <&CPU0 &CPU1 &CPU2 &CPU3>;
 		qcom,target-dev = <&memlat_cpu0>;
- 		qcom,core-dev-table =
- 			< 902400 762 >,
- 			< 1401600 2086 >,
-			< 1843200 3879 >;
- 	};
+		qcom,core-dev-table =
+			< 902400 762 >,
+			< 1401600 2086 >,
+			< 1881600 3879 >;
+	};
 
 	devfreq_memlat_4: qcom,arm-memlat-mon-4 {
 		compatible = "qcom,arm-memlat-mon";
@@ -1343,7 +1403,7 @@
 			< 1113600 762 >,
 			< 1401600 3879 >,
 			< 2150400 5931 >,
- 			< 2457600 6881 >;
+			< 2457600 6881 >;
 	};
 
 	devfreq_cpufreq: devfreq-cpufreq {
@@ -1352,7 +1412,7 @@
 			cpu-to-dev-map-0 =
 				< 633600 762 >,
 				< 1401600 1571 >,
-				< 1843200 2929 >;
+				< 1881600 2929 >;
 			cpu-to-dev-map-4 =
 				< 1113600 762 >,
 				< 1401600 2086 >,
@@ -1853,7 +1913,6 @@
 		qcom,irq-mask = <0x200>;
 		interrupts = <0 157 1>;
 		label = "lpass";
-		cpu-affinity = <1 2>;
 		qcom,qos-config = <&glink_qos_adsp>;
 		qcom,ramp-time = <0xaf>;
 	};
@@ -2355,7 +2414,7 @@
 			<&clock_rpmcc QSEECOM_CE1_CLK>,
 			<&clock_rpmcc QSEECOM_CE1_CLK>;
 		qcom,ce-opp-freq = <171430000>;
-		qcom,qsee-reentrancy-support = <0>;
+		qcom,qsee-reentrancy-support = <2>;
 	};
 
 	qcom_cedev: qcedev@1de0000{
@@ -2534,10 +2593,6 @@
 		"HS_RB_G1_L1", "HS_RB_G2_L1", "HS_RB_G3_L1",
 		"MAX";
 
-		pinctrl-names = "dev-reset-assert", "dev-reset-deassert";
-		pinctrl-0 = <&ufs_dev_reset_assert>;
-		pinctrl-1 = <&ufs_dev_reset_deassert>;
-
 		resets = <&clock_gcc GCC_UFS_BCR>;
 		reset-names = "core_reset";
 
@@ -2549,12 +2604,13 @@
 		reg = <0x786040 0x8>;
 		reg-names = "fuse-base";
 	};
+
 	sn_fuse: snfuse@0xA4128 {
-        compatible = "qcom,sn-fuse";
-        reg = <0x786134 0x4>,
-              <0x78607C 0x4>;
-        reg-names = "sn-base","fuse-state";
-       };
+		compatible = "qcom,sn-fuse";
+		reg = <0x786134 0x4>,
+				<0x78607C 0x4>;
+		reg-names = "sn-base","fuse-state";
+	};
 
 	jtag_mm0: jtagmm@7840000 {
 		compatible = "qcom,jtagv8-mm";
@@ -2820,4 +2876,3 @@
 
 #include "sdm660-mdss.dtsi"
 #include "sdm660-mdss-pll.dtsi"
-#include "sdm660-thermal.dtsi"
